



app.post('/resize', upload.single('image'), async (req, res) => {
  const { width, height } = req.body;
  const file = req.file;

  const resizedImage = await sharp(file.path)
    .resize(parseInt(width), parseInt(height))
    .toBuffer();

  const ori = await sharp(file.path).clone().toBuffer();

  const Metadataori = await sharp(ori).metadata();
  const Metadataresize = await sharp(resizedImage).metadata();

  const resultHtml = `
    <img src="data:image/png;base64, ${ori.toString('base64')}" />
    <p>Height : ${Metadataori.height}</p>
    <p>Width : ${Metadataori.width}</p>
    <img src="data:image/png;base64, ${resizedImage.toString('base64')}" />
    <p>Height : ${Metadataresize.height}</p>
    <p>Width : ${Metadataresize.width}</p>
  `;

  res.send(resultHtml);
});

$(document).ready(function() {
  $('#resizeForm').submit(function(event) {
    event.preventDefault(); // Mencegah pengiriman form secara default

    var formData = new FormData(this);

    $.ajax({
      url: '/resize',
      type: 'POST',
      data: formData,
      processData: false,
      contentType: false,
      success: function(response) {
        $('#resultContainer').html(response);
      }
    });
  });
});
